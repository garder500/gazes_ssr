var t=Object.defineProperty,e=(e,i,s)=>(((e,i,s)=>{i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s})(e,"symbol"!=typeof i?i+"":i,s),s);import{w as i,x as s,y as r,z as n,A as a,B as c,E as u,F as h,D as o,G as l,H as d}from"./index-8fe412d1.js";import{H as p}from"./provider-572956bc.js";class g{constructor(t,e){this.aa=t,this.ph=e,t.textTracks.onaddtrack=this.fa.bind(this),i(this.Hh.bind(this))}fa(t){const e=t.track;if(!e||function(t,e){return Array.from(t.children).find((t=>t.track===e))}(this.aa,e))return;const i=new s({id:e.id,kind:e.kind,label:e.label,language:e.language,type:"vtt"});i[r]={track:e},i[n]=2,i[a]=!0;let c=0;const u=t=>{if(e.cues)for(let s=c;s<e.cues.length;s++)i.addCue(e.cues[s],t),c++};u(t),e.oncuechange=u,this.ph.textTracks.add(i,t),i.setMode(e.mode,t)}Hh(){var t;this.aa.textTracks.onaddtrack=null;for(const e of this.ph.textTracks){const i=null==(t=e[r])?void 0:t.track;(null==i?void 0:i.oncuechange)&&(i.oncuechange=null)}}}class v{constructor(t,i){e(this,"Hc",((t,e)=>{this.k.delegate.R("picture-in-picture-change",{detail:t,trigger:e})})),this.aa=t,this.k=i,c(this.aa,"enterpictureinpicture",this.ri.bind(this)),c(this.aa,"leavepictureinpicture",this.si.bind(this))}get active(){return document.pictureInPictureElement===this.aa}get supported(){return u(this.aa)}async enter(){return this.aa.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}ri(t){this.Hc(!0,t)}si(t){this.Hc(!1,t)}}class f{constructor(t,i){e(this,"Ga","inline"),this.aa=t,this.k=i,c(this.aa,"webkitpresentationmodechanged",this.wi.bind(this))}get vi(){return h(this.aa)}async ui(t){this.Ga!==t&&this.aa.webkitSetPresentationMode(t)}wi(){var t;const e=this.Ga;this.Ga=this.aa.webkitPresentationMode,null==(t=this.k.player)||t.dispatchEvent(new o("video-presentation-change",{detail:this.Ga,trigger:event})),["fullscreen","picture-in-picture"].forEach((t=>{this.Ga!==t&&e!==t||this.k.delegate.R(`${t}-change`,{detail:this.Ga===t,trigger:event})}))}}class k{constructor(t){this.ti=t}get active(){return"fullscreen"===this.ti.Ga}get supported(){return this.ti.vi}async enter(){this.ti.ui("fullscreen")}async exit(){this.ti.ui("inline")}}class b{constructor(t){this.ti=t}get active(){return"picture-in-picture"===this.ti.Ga}get supported(){return this.ti.vi}async enter(){this.ti.ui("picture-in-picture")}async exit(){this.ti.ui("inline")}}class y extends p{constructor(t,i){if(super(t),e(this,"$$PROVIDER_TYPE","VIDEO"),e(this,"fullscreen"),e(this,"pictureInPicture"),h(t)){const e=new f(t,i);this.fullscreen=new k(e),this.pictureInPicture=new b(e)}else u(t)&&(this.pictureInPicture=new v(t,i))}get type(){return"video"}setup(t){super.setup(t),l(this.video)&&new g(this.video,t),t.textRenderers[d](this.video),i((()=>{t.textRenderers[d](null)})),"video"===this.type&&t.delegate.R("provider-setup",{detail:this})}get video(){return this.k}}export{y as VideoProvider};
//# sourceMappingURL=provider-1ba67cbd.js.map
