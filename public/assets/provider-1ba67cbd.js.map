{"version":3,"file":"provider-1ba67cbd.js","sources":["../../spa/node_modules/.pnpm/vidstack@0.6.14/node_modules/vidstack/dist/prod/providers/video/native-hls-text-tracks.js","../../spa/node_modules/.pnpm/vidstack@0.6.14/node_modules/vidstack/dist/prod/providers/video/picture-in-picture.js","../../spa/node_modules/.pnpm/vidstack@0.6.14/node_modules/vidstack/dist/prod/providers/video/presentation/video-presentation.js","../../spa/node_modules/.pnpm/vidstack@0.6.14/node_modules/vidstack/dist/prod/providers/video/provider.js"],"sourcesContent":["import { onDispose } from 'maverick.js';\nimport { G as TextTrack, Y as TEXT_TRACK_NATIVE, H as TEXT_TRACK_READY_STATE, Z as TEXT_TRACK_NATIVE_HLS } from '../../media-core.js';\n\nclass NativeHLSTextTracks {\n  constructor(_video, _context) {\n    this.aa = _video;\n    this.ph = _context;\n    _video.textTracks.onaddtrack = this.fa.bind(this);\n    onDispose(this.Hh.bind(this));\n  }\n  fa(event) {\n    const nativeTrack = event.track;\n    if (!nativeTrack || findTextTrackElement(this.aa, nativeTrack))\n      return;\n    const track = new TextTrack({\n      id: nativeTrack.id,\n      kind: nativeTrack.kind,\n      label: nativeTrack.label,\n      language: nativeTrack.language,\n      type: \"vtt\"\n    });\n    track[TEXT_TRACK_NATIVE] = { track: nativeTrack };\n    track[TEXT_TRACK_READY_STATE] = 2;\n    track[TEXT_TRACK_NATIVE_HLS] = true;\n    let lastIndex = 0;\n    const onCueChange = (event2) => {\n      if (!nativeTrack.cues)\n        return;\n      for (let i = lastIndex; i < nativeTrack.cues.length; i++) {\n        track.addCue(nativeTrack.cues[i], event2);\n        lastIndex++;\n      }\n    };\n    onCueChange(event);\n    nativeTrack.oncuechange = onCueChange;\n    this.ph.textTracks.add(track, event);\n    track.setMode(nativeTrack.mode, event);\n  }\n  Hh() {\n    this.aa.textTracks.onaddtrack = null;\n    for (const track of this.ph.textTracks) {\n      const nativeTrack = track[TEXT_TRACK_NATIVE]?.track;\n      if (nativeTrack?.oncuechange)\n        nativeTrack.oncuechange = null;\n    }\n  }\n}\nfunction findTextTrackElement(video, track) {\n  return Array.from(video.children).find((el) => el.track === track);\n}\n\nexport { NativeHLSTextTracks as N };\n","import { listenEvent } from 'maverick.js/std';\nimport { _ as canUsePictureInPicture } from '../../media-core.js';\n\nclass VideoPictureInPicture {\n  constructor(_video, _media) {\n    this.aa = _video;\n    this.k = _media;\n    listenEvent(this.aa, \"enterpictureinpicture\", this.ri.bind(this));\n    listenEvent(this.aa, \"leavepictureinpicture\", this.si.bind(this));\n  }\n  get active() {\n    return document.pictureInPictureElement === this.aa;\n  }\n  get supported() {\n    return canUsePictureInPicture(this.aa);\n  }\n  async enter() {\n    return this.aa.requestPictureInPicture();\n  }\n  exit() {\n    return document.exitPictureInPicture();\n  }\n  ri(event) {\n    this.Hc(true, event);\n  }\n  si(event) {\n    this.Hc(false, event);\n  }\n  Hc = (active, event) => {\n    this.k.delegate.R(\"picture-in-picture-change\", {\n      detail: active,\n      trigger: event\n    });\n  };\n}\n\nexport { VideoPictureInPicture as V };\n","import { listenEvent, DOMEvent } from 'maverick.js/std';\nimport { $ as canUseVideoPresentation } from '../../../media-core.js';\n\nclass VideoPresentation {\n  constructor(_video, _media) {\n    this.aa = _video;\n    this.k = _media;\n    listenEvent(this.aa, \"webkitpresentationmodechanged\", this.wi.bind(this));\n  }\n  Ga = \"inline\";\n  get vi() {\n    return canUseVideoPresentation(this.aa);\n  }\n  async ui(mode) {\n    if (this.Ga === mode)\n      return;\n    this.aa.webkitSetPresentationMode(mode);\n  }\n  wi() {\n    const prevMode = this.Ga;\n    this.Ga = this.aa.webkitPresentationMode;\n    this.k.player?.dispatchEvent(\n      new DOMEvent(\"video-presentation-change\", {\n        detail: this.Ga,\n        trigger: event\n      })\n    );\n    [\"fullscreen\", \"picture-in-picture\"].forEach((type) => {\n      if (this.Ga === type || prevMode === type) {\n        this.k.delegate.R(`${type}-change`, {\n          detail: this.Ga === type,\n          trigger: event\n        });\n      }\n    });\n  }\n}\nclass FullscreenPresentationAdapter {\n  constructor(_presentation) {\n    this.ti = _presentation;\n  }\n  get active() {\n    return this.ti.Ga === \"fullscreen\";\n  }\n  get supported() {\n    return this.ti.vi;\n  }\n  async enter() {\n    this.ti.ui(\"fullscreen\");\n  }\n  async exit() {\n    this.ti.ui(\"inline\");\n  }\n}\nclass PIPPresentationAdapter {\n  constructor(_presentation) {\n    this.ti = _presentation;\n  }\n  get active() {\n    return this.ti.Ga === \"picture-in-picture\";\n  }\n  get supported() {\n    return this.ti.vi;\n  }\n  async enter() {\n    this.ti.ui(\"picture-in-picture\");\n  }\n  async exit() {\n    this.ti.ui(\"inline\");\n  }\n}\n\nexport { FullscreenPresentationAdapter as F, PIPPresentationAdapter as P, VideoPresentation as V };\n","import { onDispose } from 'maverick.js';\nimport { $ as canUseVideoPresentation, _ as canUsePictureInPicture, X as canPlayHLSNatively, a0 as ATTACH_VIDEO } from '../../media-core.js';\nimport { H as HTMLMediaProvider } from '../html/provider.js';\nimport { N as NativeHLSTextTracks } from './native-hls-text-tracks.js';\nimport { V as VideoPictureInPicture } from './picture-in-picture.js';\nimport { V as VideoPresentation, F as FullscreenPresentationAdapter, P as PIPPresentationAdapter } from './presentation/video-presentation.js';\nimport 'maverick.js/element';\nimport 'maverick.js/std';\nimport '../type-check.js';\nimport '../audio/loader.js';\nimport 'maverick.js/dom';\nimport '../hls/loader.js';\nimport './loader.js';\nimport '../html/htmlâ€“media-events.js';\nimport '../hls/hls.js';\nimport '../../media-ui.js';\nimport '../../icons/icon.js';\nimport 'media-captions';\nimport '../html/native-audio-tracks.js';\n\nclass VideoProvider extends HTMLMediaProvider {\n  $$PROVIDER_TYPE = \"VIDEO\";\n  get type() {\n    return \"video\";\n  }\n  fullscreen;\n  pictureInPicture;\n  constructor(video, context) {\n    super(video);\n    if (canUseVideoPresentation(video)) {\n      const presentation = new VideoPresentation(video, context);\n      this.fullscreen = new FullscreenPresentationAdapter(presentation);\n      this.pictureInPicture = new PIPPresentationAdapter(presentation);\n    } else if (canUsePictureInPicture(video)) {\n      this.pictureInPicture = new VideoPictureInPicture(video, context);\n    }\n  }\n  setup(context) {\n    super.setup(context);\n    if (canPlayHLSNatively(this.video)) {\n      new NativeHLSTextTracks(this.video, context);\n    }\n    context.textRenderers[ATTACH_VIDEO](this.video);\n    onDispose(() => {\n      context.textRenderers[ATTACH_VIDEO](null);\n    });\n    if (this.type === \"video\")\n      context.delegate.R(\"provider-setup\", { detail: this });\n  }\n  /**\n   * The native HTML `<video>` element.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement}\n   */\n  get video() {\n    return this.k;\n  }\n}\n\nexport { VideoProvider };\n"],"names":["NativeHLSTextTracks","constructor","_video","_context","this","aa","ph","textTracks","onaddtrack","fa","bind","onDispose","Hh","event","nativeTrack","track","video","Array","from","children","find","el","findTextTrackElement","TextTrack","id","kind","label","language","type","TEXT_TRACK_NATIVE","TEXT_TRACK_READY_STATE","TEXT_TRACK_NATIVE_HLS","lastIndex","onCueChange","event2","cues","i","length","addCue","oncuechange","add","setMode","mode","_a","VideoPictureInPicture","_media","__publicField","active","k","delegate","R","detail","trigger","listenEvent","ri","si","document","pictureInPictureElement","supported","canUsePictureInPicture","enter","requestPictureInPicture","exit","exitPictureInPicture","Hc","VideoPresentation","wi","vi","canUseVideoPresentation","ui","Ga","webkitSetPresentationMode","prevMode","webkitPresentationMode","player","dispatchEvent","DOMEvent","forEach","FullscreenPresentationAdapter","_presentation","ti","PIPPresentationAdapter","VideoProvider","HTMLMediaProvider","context","super","presentation","fullscreen","pictureInPicture","setup","canPlayHLSNatively","textRenderers","ATTACH_VIDEO"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}